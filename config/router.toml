# Rust Router Configuration

[router]
# Unique identifier for this router (used as BGP router-id)
router_id = "10.0.0.1"
# Log level: trace, debug, info, warn, error
log_level = "info"

# Network interfaces for routing
# At least one WAN and one LAN interface required

[[interfaces]]
name = "eth0"
role = "wan"
# Optional: IP address if needed for management
# address = "10.0.0.1/24"

[[interfaces]]
name = "eth1"
role = "lan"
# address = "192.168.1.1/24"

# BGP Configuration (optional)
[bgp]
local_as = 65001
listen_port = 179

# BGP peers
[[bgp.peers]]
address = "10.0.0.2"
remote_as = 65002
flowspec = true
# password = "secret"  # Optional MD5 password

# IPFIX Export Configuration (optional)
[ipfix]
collector = "10.0.0.100:4739"
export_interval_secs = 60
observation_domain_id = 1

# REST API Configuration (optional)
[api]
listen = "127.0.0.1:8080"

# FlowSpec Configuration
[flowspec]
# Default action when no rule matches: accept, drop
default_action = "accept"

# Static FlowSpec rules (in addition to BGP-learned rules)
[[flowspec.rules]]
name = "block-ssh-bruteforce"
dst_port = { start = 22, end = 22 }
protocol = 6  # TCP
action = "rate_limit"
rate_limit_bps = 10000  # 10 KB/s

[[flowspec.rules]]
name = "block-dns-amplification"
src_port = { start = 53, end = 53 }
protocol = 17  # UDP
action = "rate_limit"
rate_limit_bps = 100000  # 100 KB/s

# Example: Block specific IP range
# [[flowspec.rules]]
# name = "block-badactor"
# src_prefix = "192.0.2.0/24"
# action = "drop"
